---
import { Sparkles } from "lucide-react";
import dashboardPreview from "@/assets/dashboard-preview.webp"; 
import HeroInteraction from "@/components/HeroInteraction";
import HeroCarousel from "@/components/HeroCarousel.astro";
import DigitizeGallery from "@/components/react/carousel/DigitizeGallery";
import VisibilityGallery from "@/components/react/carousel/VisibilityGallery";
import CapacityGallery from "@/components/react/carousel/CapacityGallery";
import CarriersGallery from "@/components/react/carousel/CarriersGallery";
// Import correct types
import type { HeroContent, HeroSlide, DigitizeGalleryData, VisibilityGalleryData, CapacityGalleryData, CarriersGalleryData } from "@/data/pagesData";

interface Props {
  content: HeroContent;
  digitizeGallery?: DigitizeGalleryData;
  visibilityGallery?: VisibilityGalleryData;
  capacityGallery?: CapacityGalleryData;
  carriersGallery?: CarriersGalleryData;
}

const { content, digitizeGallery, visibilityGallery, capacityGallery, carriersGallery } = Astro.props;

const defaultSlides: HeroSlide[] = [
  {
    type: "single",
    images: [content.desktopImage || dashboardPreview]
  }
];

const slidesToRender = content.heroSlides || defaultSlides;
---

<section class="relative bg-gradient-hero py-16 px-4 sm:px-6 lg:px-8">
  {/* NEW: Dot Pattern Background (White dots for Orange background) */}
  <div class="absolute inset-0 z-0 pointer-events-none overflow-hidden">
    <svg class="absolute w-full h-full" xmlns="http://www.w3.org/2000/svg" opacity="0.2">
      <defs>
        <pattern id="hero-matrix-dots" x="0" y="0" width="24" height="24" patternUnits="userSpaceOnUse">
          {/* UPDATED: fill="white" so it's visible on orange */}
          <circle cx="2" cy="2" r="1.5" fill="white" />
        </pattern>
      </defs>
      <rect width="100%" height="100%" fill="url(#hero-matrix-dots)" />
    </svg>
  </div>
  
  <div class="relative mx-auto max-w-7xl">
    <div class="text-center">
      
      {/* UPDATED: Reverted to white text/icon for contrast on Orange */}
      <div class="inline-flex items-center gap-1 sm:gap-2 rounded-full bg-primary-foreground/10 px-2 sm:px-3 py-1 mb-8 backdrop-blur-sm">
        <Sparkles className="h-3 w-3 sm:h-4 sm:w-4 text-primary-foreground" />
        <span class="text-xs sm:text-sm font-medium text-primary-foreground whitespace-nowrap">
          {content.badgeText}
        </span>
      </div>
      
      {/* UPDATED: Reverted to white text */}
      <h1 class="
        responsive-headline
        font-bruta font-bold text-center text-primary-foreground leading-[1.1] tracking-tight mb-8 mx-auto
        text-balance
      ">
        {content.headline}
      </h1>

      <HeroInteraction 
        client:load
        buttonText={content.buttonText}
        placeholder={content.emailPlaceholder}
        fitContent={!!visibilityGallery}
      >
        
        {visibilityGallery ? (
           <VisibilityGallery 
             client:visible={{ rootMargin: "200px" }}
             baseImage={visibilityGallery.baseImage}
             overlayImage={visibilityGallery.overlayImage}
             galleryImages={visibilityGallery.galleryImages}
           />
        ) : carriersGallery ? (
           <CarriersGallery
             client:visible={{ rootMargin: "200px" }}
             masterImage={carriersGallery.masterImage}
             mobileImages={carriersGallery.mobileImages}
             galleryImages={carriersGallery.galleryImages}
             hotspots={carriersGallery.hotspots}
           />
        ) : capacityGallery ? (
           <CapacityGallery 
             client:visible={{ rootMargin: "200px" }}
             image={capacityGallery.staticImage}
           />
        ) : digitizeGallery ? (
           <DigitizeGallery 
             client:visible={{ rootMargin: "200px" }} 
             headerImage={digitizeGallery.header} 
             gridImages={digitizeGallery.gridImages} 
           />
        ) : (
           <div class="w-full h-full">
             <HeroCarousel slides={slidesToRender} />
           </div>
        )}

      </HeroInteraction>

    </div>
  </div>
</section>

<style>
  .responsive-headline {
    font-size: 9vw;
    max-width: 100%;
  }
  @media (min-width: 640px) {
    .responsive-headline { font-size: 7vw; max-width: 90%; }
  }
  @media (min-width: 1024px) {
    .responsive-headline { font-size: 5vw; max-width: 85%; }
  }
  @media (min-width: 1280px) {
    .responsive-headline { font-size: 80px; max-width: 1200px; }
  }
</style>