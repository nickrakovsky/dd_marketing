---
// 1. Interactive Components
import Navigation from "./Navigation"; 
import FAQ from "./FAQ";
import { Toaster } from "@/components/ui/sonner";

// 2. Static-Capable Components
import Testimonial from "./Testimonial";
import Benefits from "./Benefits";
import Credibility from "./Credibility";
import HowItWorks from "./HowItWorks";
import CaseStudies from "./CaseStudies";
import Integrations from "./Integrations";

// 3. The Astro Native Component
import Hero from "./Hero.astro";
import type { PageContent } from "@/data/pagesData";
import Footer from "./Footer.astro";

// --- IMAGE IMPORTS ---
import { getImage } from "astro:assets";
import capterraSrc from "@/assets/capterra-logo.png";
import g2Src from "@/assets/g2-logo.webp";

interface Props {
  content: PageContent;
}

const { content } = Astro.props;

// --- IMAGE PROCESSING ---
// This runs on the server to create small, optimized thumbnails
const optimizedCapterra = await getImage({ src: capterraSrc, format: 'webp', width: 100 });
const optimizedG2 = await getImage({ src: g2Src, format: 'webp', width: 100 });
---

<div class="min-h-screen">
  
  {/* Needs client:load for mobile menu toggling */}
  <Navigation client:load />
  
  {/* Hero contains internal islands like the Gallery that manage their own loading */}
  <Hero 
    content={content.hero} 
    digitizeGallery={content.digitizeGallery}
    visibilityGallery={content.visibilityGallery}
    capacityGallery={content.capacityGallery}
    carriersGallery={content.carriersGallery}
  />
  
  {/* Static HTML: Zero JS payload. Image loads normally. */}
  <Testimonial content={content.testimonial} />
  
  {/* Static HTML: Hover effects work via CSS. */}
  <Benefits content={content.benefits} />
  
  {/* Static HTML: Infinite marquee works via CSS animation. */}
  <Credibility 
    content={content.credibility} 
    images={{
      capterra: optimizedCapterra.src,
      g2: optimizedG2.src
    }}
  />
  
  {/* Static HTML: Responsive grid works via CSS media queries. */}
  <HowItWorks content={content.howItWorks} />
  
  {/* Static HTML: Renders list/grid layout server-side. */}
  <CaseStudies content={content.caseStudies} />
  
  {/* Static HTML */}
  <Integrations />
  
  {/* Needs client:idle for Accordion open/close state */}
  <FAQ client:idle content={content.faq} />

  <Footer />

  {/* Needs client:idle to listen for toast events */}
  <Toaster client:idle />
</div>